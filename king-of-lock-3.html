<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="keywords" content="智能锁安全,智能锁安全,终端安全,智能快递柜破解，智能终端安全"><meta name="description" content="智能门锁安全研究自然离不开芯片层面的攻防，数智安全研究院深耕芯片安全多年，在这一块也有所积累，接下来通过一些具体案例介绍一下智能锁中的芯片安全。"><title>《锁王创造营》第三关：釜底抽薪 | Yaseng</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/rss.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">《锁王创造营》第三关：釜底抽薪</h1><a id="logo" href="/.">Yaseng</a><p class="description">Bypass the token</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/project/"><i class="fa fa-reorder"> Project</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/rss.xml"><i class="fa fa-rss"> Rss</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">《锁王创造营》第三关：釜底抽薪</h1><div class="post-meta">May 23, 2020<span> | </span><span class="category"><a href="/categories/物联网安全/">物联网安全</a></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#智能锁芯片安全"><span class="toc-number">2.</span> <span class="toc-text">智能锁芯片安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#芯片调试"><span class="toc-number">2.1.</span> <span class="toc-text">芯片调试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#预留接口调试"><span class="toc-number">2.1.1.</span> <span class="toc-text">预留接口调试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#直连芯片-JTAG-引脚调试"><span class="toc-number">2.1.2.</span> <span class="toc-text">直连芯片 JTAG 引脚调试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#芯片读取"><span class="toc-number">2.2.</span> <span class="toc-text">芯片读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jtag提取固件"><span class="toc-number">2.2.1.</span> <span class="toc-text">jtag提取固件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绕过读保护读取固件"><span class="toc-number">2.2.2.</span> <span class="toc-text">绕过读保护读取固件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#毛刺攻击绕过读保护"><span class="toc-number">2.2.3.</span> <span class="toc-text">毛刺攻击绕过读保护</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#物理攻击"><span class="toc-number">2.3.</span> <span class="toc-text">物理攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三关：Hanoi"><span class="toc-number">3.</span> <span class="toc-text">第三关：Hanoi</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解锁"><span class="toc-number">3.1.</span> <span class="toc-text">解锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">4.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/0.png" alt="img"></p>
<p>15日，美国商务部公告升级了对华为的芯片管制，即便芯片本身不是由美国来开发设计，但是只要外国公司使用了美国芯片的制造设备，就必须获得美国政府的许可，才能向华为或其附属公司提供芯片。华为想要继续获取某些芯片或使用某些美国软件或技术相关的半导体设计，也必须获得美国的许可。</p>
<p>芯片是科技发展的基础，一个企业甚至国家的核心竞争力，一直以来，国人都在想方设法摆脱在芯片领域被“卡脖子”的状态，例如龙芯、飞腾、兆芯，但全球芯片生态和技术迭代的时机又一次次表明这注定是一个“路漫漫其修远兮”的艰苦过程，不过也正像上图华为回应的那样“回头看，崎岖坎坷;向前看，永不言弃。”破釜沉舟、背水一战，才是唯一出路。</p>
<p>智能门锁安全研究自然离不开芯片层面的攻防，数智安全研究院深耕芯片安全多年，在这一块也有所积累，接下来通过一些具体案例介绍一下智能锁中的芯片安全。</p>
<h2 id="智能锁芯片安全"><a href="#智能锁芯片安全" class="headerlink" title="智能锁芯片安全"></a>智能锁芯片安全</h2><h3 id="芯片调试"><a href="#芯片调试" class="headerlink" title="芯片调试"></a>芯片调试</h3><h4 id="预留接口调试"><a href="#预留接口调试" class="headerlink" title="预留接口调试"></a>预留接口调试</h4><p>如果PCB上保留了厂商在研发过程中预留的 SWD 接口，可直接通过飞线的方式，连上对应的引脚进行调试。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/1.jpg" alt=""></p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/2.png" alt=""></p>
<p>连接 gdb 进行调试。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/3.png" alt="img"></p>
<h4 id="直连芯片-JTAG-引脚调试"><a href="#直连芯片-JTAG-引脚调试" class="headerlink" title="直连芯片 JTAG 引脚调试"></a>直连芯片 JTAG 引脚调试</h4><p>大部分厂商在生产环节会去掉外部引出的 JTAG 接口，因为多数量产芯片的封装格式，直接飞线难度较大，因此可以采用探针台直连芯片引脚进行调试。在研究的某款智能锁，拆解发现采用的是 MSP432G2553 作为主控，下图红框位置。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/4.png" alt="img"></p>
<p>该款智能锁利用手机 app 产生开锁音频信号，进过外部 AD 转换后传输至芯片中进行解密开锁处理，厂商在生产过程中比较注重安全意识，PC 上的没有保留调试接口，进一步分析的话，需要对芯片进行固件提取和在线调试。</p>
<p>查TI官方手册，MSP432G2553 芯片引脚定义如下，其支持四线 JTAG 和两线 SBW 的调试接口，随采用两线制 SBW 接口作为调试方式，其 16 引脚为 SBWTDIO 口，17脚为 SBWTCK 脚。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/5.jpg" alt="img"></p>
<p>连接引脚</p>
<p>两线制 SBW 对应 MSP430 仿真器上的14线排针接口，分别为 16 脚 SBWTDIO 口连仿真器第一脚 TDO，17脚 SBWTCK 连第7脚 TCK，最后需要连接 GND 脚，即芯片的第 20 脚连仿真器第9口，两线制 SBW 同时需要外部电源供电，仿真器接口定义如下图。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/6.jpg" alt="img"></p>
<p>按照引脚说明，开始在探针台上连接引脚，需要注意 JTAG 和 SBW 调试，对连线的长度有严格要求，超过 20 厘米信号会大幅衰减，造成无法调试，因此在探针上利用夹子和铜导线缩小接线距离。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/7.png" alt="img"></p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/8.png" alt="img"></p>
<p>在线调试<br>连接上仿真器，启动 msp430-gdbproxy。msp430-gdb 远程连接 target remote 192.168.1.196:2000</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/9.jpg" alt="img"></p>
<p>接下来可以结合固件分析，协议分析等进一步研究此款锁的安全性。</p>
<h3 id="芯片读取"><a href="#芯片读取" class="headerlink" title="芯片读取"></a>芯片读取</h3><h4 id="jtag提取固件"><a href="#jtag提取固件" class="headerlink" title="jtag提取固件"></a>jtag提取固件</h4><p>拆焊芯片<br>首先用热风枪拆下智能锁主控芯片，该单片机型号为 ：Stm32F103R6。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/10.png" alt="img"></p>
<p>烧录座连接Jlink<br>芯片第一脚对齐烧录座第一脚，然后把 Jlink 插入烧录座引出的 JTAG 接口。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/11.png" alt="img"></p>
<p>读取固件<br>电脑上安装好 Jlink 驱动，打开 J-Flash 客户端，设置好参数，主要在配置栏选择正确的芯片型号，然后点击连接，在点击 Target-&gt;Read Back-&gt;Entire trip 即可读写固件。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/12.jpg" alt="img"></p>
<h4 id="绕过读保护读取固件"><a href="#绕过读保护读取固件" class="headerlink" title="绕过读保护读取固件"></a>绕过读保护读取固件</h4><p>拆开智能锁，找到PCB电路板中芯片的位置，可以直接看出芯片型号为nRF51802 。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/13.png" alt="img"></p>
<p>通过查阅芯片手册，找到电路板上的芯片SWD调试接口，通过JLINK连接，发现芯片设置了读保护。<br>由UICR(用户信息配置寄存器)中的RBPCONF(0x10001004)寄存器处理，如果设置为0xFFFF00FF，则启用读出保护，默认值为0xFFFFFFFF。<br>通过调试端口查看：mdw 0x10001004读取</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/14.png" alt="img"></p>
<p>可知智能锁有读保护。</p>
<p>查阅资料发现可以通过修改寄存器中的值为我们期望的内存地址，并传递给加载指令可以绕过读保护提取出固件。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/15.png" alt="img"></p>
<h4 id="毛刺攻击绕过读保护"><a href="#毛刺攻击绕过读保护" class="headerlink" title="毛刺攻击绕过读保护"></a>毛刺攻击绕过读保护</h4><p>除了使用软件漏洞，通过电压、电磁等毛刺攻击也可以绕过读保护 。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/16.jpg" alt="img"></p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/17.jpg" alt="img"></p>
<p>(毛刺攻击 stm32 芯片 来源：chip.fail)</p>
<h3 id="物理攻击"><a href="#物理攻击" class="headerlink" title="物理攻击"></a>物理攻击</h3><p>通过电磁注入芯片，产生重置信号，实现开锁。 </p>
<video id="video" controls preload="none"><br>    <source id="mp4" src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/1590137272703594.mp4"><br></video>

<p>某款共享单车电路设计和机械构造存在问题，可以从外部截断输入锁体的电源线，再用一个高电压的脉冲电压作为输入电源，即可开锁。其原因在于电路设计和电机控制芯片选型存在缺陷，没有做充分的过载保护和断路保护，使控制锁柱运动的电机异常工作。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/18.jpg" alt="img"></p>
<p>以上为我们本期《锁王创造营》所分享的关于智能锁芯片安全的具体案例，希望能让您对智能锁具芯片安全的认知有所帮助。</p>
<p>在上一期《锁王创造营》中，我们成功解锁了第二关“Sydney”，今天我们将继续破解第三关——“Hanoi”。</p>
<h2 id="第三关：Hanoi"><a href="#第三关：Hanoi" class="headerlink" title="第三关：Hanoi"></a>第三关：Hanoi</h2><p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/18.png" alt="img"></p>
<p>首先我们浏览一下手册，看该版本更新了哪些内容。</p>
<blockquote>
<p>OVERVIEW</p>
<ul>
<li>This lock is attached the the LockIT Pro HSM-1.</li>
<li>We have updated  the lock firmware  to connect with the hardwaresecurity module.</li>
</ul>
<p>DETAILS</p>
<p>​    …</p>
<p>​    LockIT Pro Hardware  Security Module 1 stores  the login password,            ensuring users  can not access  the password through  other means.            The LockIT Pro  can send the LockIT Pro HSM-1  a password, and the            HSM will  return if the password  is correct by setting  a flag in            memory.</p>
</blockquote>
<p>这里说该锁连接了 HSM-1（硬件安全模块），也就是说密码在的HSM中存储，LockIT Pro可以向HSM-1发送密码，再由HSM返回结果，而我们无法直接访问它。</p>
<p>接下来，我们查看反汇编窗口，看看它到底做了什么，首先是<strong>main</strong>函数，<strong>main</strong>中除了调用<strong>login</strong>函数外，并无其他功能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4438 &lt;main&gt;</span><br><span class="line">4438: b012 2045     call   #0x4520 &lt;login&gt;</span><br><span class="line">443c: 0f43           clr   r15</span><br></pre></td></tr></table></figure>
<p>查看<strong>login</strong>函数，其中调用了一些函数，<strong>put</strong>函数、<strong>getsn</strong>函数请求用户输入、<strong>test_password_valid</strong>函数根据函数名知道其作用是测试密码有效性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">4520 &lt;login&gt;</span><br><span class="line">4520: c243 1024     mov.b   #0x0, &amp;0x2410</span><br><span class="line">4524: 3f40 7e44     mov   #0x447e &quot;Enter the password to continue.&quot;, r15</span><br><span class="line">4528: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">452c: 3f40 9e44     mov   #0x449e &quot;Remember: passwords are between 8 and 16 characters.&quot;, r15</span><br><span class="line">4530: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">4534: 3e40 1c00     mov   #0x1c, r14</span><br><span class="line">4538: 3f40 0024     mov   #0x2400, r15</span><br><span class="line">453c: b012 ce45     call   #0x45ce &lt;getsn&gt;</span><br><span class="line">4540: 3f40 0024     mov   #0x2400, r15</span><br><span class="line">4544: b012 5444     call   #0x4454 &lt;test_password_valid&gt;</span><br><span class="line">4548: 0f93           tst   r15</span><br><span class="line">454a: 0324           jz   $+0x8</span><br><span class="line">454c: f240 f100 1024 mov.b   #0xf1, &amp;0x2410</span><br><span class="line">4552: 3f40 d344     mov   #0x44d3 &quot;Testing if password is valid.&quot;, r15</span><br><span class="line">4556: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">455a: f290 c600 1024 cmp.b   #0xc6, &amp;0x2410</span><br><span class="line">4560: 0720           jne   #0x4570 &lt;login+0x50&gt;</span><br><span class="line">4562: 3f40 f144     mov   #0x44f1 &quot;Access granted.&quot;, r15</span><br><span class="line">4566: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">456a: b012 4844     call   #0x4448 &lt;unlock_door&gt;</span><br><span class="line">456e: 3041           ret</span><br><span class="line">4570: 3f40 0145     mov   #0x4501 &quot;That password is not correct.&quot;, r15</span><br><span class="line">4574: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">4578: 3041           ret</span><br></pre></td></tr></table></figure>
<p>通过开头的手册提示，我们知道密码在HSM中，我们看看<strong>test_password_valid</strong>函数做了哪些操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">4454 &lt;test_password_valid&gt;</span><br><span class="line">4454: 0412           push   r4</span><br><span class="line">4456: 0441           mov   sp, r4</span><br><span class="line">4458: 2453           incd   r4</span><br><span class="line">445a: 2183           decd   sp</span><br><span class="line">445c: c443 fcff     mov.b   #0x0, -0x4(r4)</span><br><span class="line">4460: 3e40 fcff     mov   #0xfffc, r14</span><br><span class="line">4464: 0e54           add   r4, r14</span><br><span class="line">4466: 0e12           push   r14</span><br><span class="line">4468: 0f12           push   r15</span><br><span class="line">446a: 3012 7d00     push   #0x7d</span><br><span class="line">446e: b012 7a45     call   #0x457a &lt;INT&gt;</span><br><span class="line">4472: 5f44 fcff     mov.b   -0x4(r4), r15</span><br><span class="line">4476: 8f11           sxt   r15</span><br><span class="line">4478: 3152           add   #0x8, sp</span><br><span class="line">447a: 3441           pop   r4</span><br><span class="line">447c: 3041           ret</span><br></pre></td></tr></table></figure>
<p>通过简单分析可以看到，地址0x446e调用了<strong>INT</strong>函数，根据LockIT Pro用户手册第7页，可以看到<strong>INT</strong>函数的作用是将中断号压入栈中，然后调用系统中断，在<code>call    #0x457a &lt;INT&gt;</code>上方正是将“0x7d”压入栈中，所以这是调用<strong>INT 0x7d</strong>中断。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/UJjMWugnRj6VZ2DD8LS7p4WBvv5A5OLpX5nUaxRGbdHMfKWAicdodMVpa2BWGLPFoicXEGu99eN33YD00Ro8pPibg/640?wx_fmt=png" alt="img"></p>
<p>在LockIT Pro用户手册第9页中说明，调用INT 0x7d中断后，若是密码正确，将会在某一位置上覆盖标志。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/20.png" alt="img"></p>
<p>我们回到<strong>login</strong>函数中，使用<code>break 4548</code>命令，将断点设置在调用<strong>test_password_valid</strong>后下一条指令位置，然后<code>c</code>运行，运行过程中调用请求输入函数<strong>getns</strong>，根据调用前参数，我们不知道正确的密码，依旧填“test”。在IO交互界面提示，密码在8~16字符之间。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/21.png" alt="img"></p>
<p><strong>getns</strong>有两个参数，请求输入密码的内存缓冲区地址（0x2400），以及接收的最大字节数（0x1c），所以尽管上面提示密码在8~16字符之间，我们还是可以输入28（0x1c）个字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4534: 3e40 1c00     mov   #0x1c, r14</span><br><span class="line">4538: 3f40 0024     mov   #0x2400, r15</span><br><span class="line">453c: b012 ce45     call   #0x45ce &lt;getsn&gt;</span><br></pre></td></tr></table></figure>
<p>待在0x4548断下以后，我们单步分析。在不知道密码的情况下，寄存器<strong>r15</strong>（r15存放test_password_valid函数的返回值）的值为0是必然的，所以执行<code>jz $+0x8</code>，跳过<code>mov.b #0xf1, &amp;0x2410</code>，随机打印提示测试密码是否有效字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">4544: b012 5444     call   #0x4454 &lt;test_password_valid&gt;</span><br><span class="line">4548: 0f93           tst   r15</span><br><span class="line">454a: 0324           jz   $+0x8</span><br><span class="line">454c: f240 f100 1024 mov.b   #0xf1, &amp;0x2410</span><br><span class="line">4552: 3f40 d344     mov   #0x44d3 &quot;Testing if password is valid.&quot;, r15</span><br><span class="line">4556: b012 de45     call   #0x45de &lt;puts&gt;</span><br></pre></td></tr></table></figure>
<p>随即<code>cmp.b</code>比较源操作数<strong>0xc6</strong>与地址0x2410的内容，其中目的操作数是绝对寻址模式。下一条指令<code>jne</code>，若是不相等则跳过<strong>unlock_door</strong>函数，ret返回。所以这是解锁的关键代码，猜测之前调用INT 0x7d时，若密码正确覆盖的正是这一地址。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">455a: f290 c600 1024 cmp.b   #0xc6, &amp;0x2410</span><br><span class="line">4560: 0720           jne   #0x4570 &lt;login+0x50&gt;</span><br><span class="line">4562: 3f40 f144     mov   #0x44f1 &quot;Access granted.&quot;, r15</span><br><span class="line">4566: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">456a: b012 4844     call   #0x4448 &lt;unlock_door&gt;</span><br><span class="line">456e: 3041           ret</span><br><span class="line">4570: 3f40 0145     mov   #0x4501 &quot;That password is not correct.&quot;, r15</span><br><span class="line">4574: b012 de45     call   #0x45de &lt;puts&gt;</span><br><span class="line">4578: 3041           ret</span><br></pre></td></tr></table></figure>
<p>关于寻址模式，在msp430手册中介绍，针对源操作数的七个寻址模式和针对目的操作数的四个寻址模可在完整地址空间寻址。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/22.png" alt="img"></p>
<p>还记得之我们输入的密码在内存的位置吗？密码在地址0x2400起始的缓冲区中，和0x2410只相差0x10字节，而我们可以输入0x1c个字符，此时我们可以通过“溢出”0x10字符的范围，覆盖到地址0x2410中。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/23.png" alt="img"></p>
<h3 id="解锁"><a href="#解锁" class="headerlink" title="解锁"></a>解锁</h3><p>我们已经确定了解决方案，下面开始解锁。</p>
<p>填充0x10字节数据，在其末尾加上0xc6即可。</p>
<p>以16进制编码输入：41414141414141414141414141414141c6。</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/24.png" alt="img"></p>
<p>成功解锁！</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/25.png" alt="img"></p>
<p>以上就是本期《锁王创造营》的全部内容，对闯关以及其他问题感兴趣的小伙伴可以加一下我们的技术交流群哦！</p>
<p><img src="https://yaseng-1251294608.cos.ap-guangzhou.myqcloud.com/2020/5/4/26.jpg" alt="img"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li>MSP430 用户指南 <a href="http://www.ti.com.cn/cn/lit/ug/zhcu032i/zhcu032i.pdf" target="_blank" rel="noopener">http://www.ti.com.cn/cn/lit/ug/zhcu032i/zhcu032i.pdf</a> </li>
<li>智能锁具攻防一:初探 <a href="https://yaseng.org/intelligent-lock-attack-and-defense-1.html">https://yaseng.org/intelligent-lock-attack-and-defense-1.html</a></li>
<li>智能锁行业安全分析报告 <a href="https://yaseng.org/intelligent-lock-industry-safety-report.html">https://yaseng.org/intelligent-lock-industry-safety-report.html</a></li>
<li>物联网安全百科 <a href="https://iot-security.wiki" target="_blank" rel="noopener">https://iot-security.wiki</a></li>
<li>nrf51822 绕过读保护 <a href="https://www.pentestpartners.com/security-blog/nrf51822-code-readout-protection-bypass-a-how-to/" target="_blank" rel="noopener">https://www.pentestpartners.com/security-blog/nrf51822-code-readout-protection-bypass-a-how-to/</a></li>
<li>错误注入绕过大多数现代化的芯片读保护 <a href="https://chip.fail/" target="_blank" rel="noopener">https://chip.fail/</a></li>
</ol>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yaseng.org/king-of-lock-3.html" data-id="cketx46d900qne5wma97wujha" class="article-share-link">分享到</a><div class="tags"><a href="/tags/终端安全/">终端安全</a><a href="/tags/智能锁安全/">智能锁安全</a><a href="/tags/智能锁破解/">智能锁破解</a><a href="/tags/指纹锁安全/">指纹锁安全</a><a href="/tags/指纹锁破解/">指纹锁破解</a><a href="/tags/长毛锁王/">长毛锁王</a><a href="/tags/锁具-ctf/">锁具 ctf</a><a href="/tags/智能快递柜破解/">智能快递柜破解</a><a href="/tags/智能终端安全/">智能终端安全</a></div><div class="post-nav"><a href="/king-of-lock-4.html" class="pre">《锁王创造营》 第四关：两会专题</a><a href="/king-of-lock-2.html" class="next">《锁王创造营》第二关：暗度陈仓</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yaseng.org"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hack/">Hack</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Hack/学习资料/">学习资料</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hack/安全参考/">安全参考</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hack/技术文章/">技术文章</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Yaseng/">Yaseng</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Yaseng/原创作品/">原创作品</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web安全/">web安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/代码审计/">代码审计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/内核安全/">内核安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端安全/">前端安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链安全/">区块链安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/原创作品/">原创作品</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习资料/">学习资料</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全参考/">安全参考</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术文章/">技术文章</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术文章/代码审计/">代码审计</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据安全/">数据安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/无线电安全/">无线电安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/渗透测试/">渗透测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/物理攻击/">物理攻击</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/物联网安全/">物联网安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/终端安全/">终端安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/芯片安全/">芯片安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/西部大开发/">西部大开发</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/jQuery-弹幕插件/" style="font-size: 15px;">jQuery 弹幕插件</a> <a href="/tags/discuz-插件/" style="font-size: 15px;">discuz 插件</a> <a href="/tags/原创作品/" style="font-size: 15px;">原创作品</a> <a href="/tags/90sec/" style="font-size: 15px;">90sec</a> <a href="/tags/代码审计/" style="font-size: 15px;">代码审计</a> <a href="/tags/Yaseng/" style="font-size: 15px;">Yaseng</a> <a href="/tags/asm/" style="font-size: 15px;">asm</a> <a href="/tags/wget/" style="font-size: 15px;">wget</a> <a href="/tags/91736cms-漏洞/" style="font-size: 15px;">91736cms 漏洞</a> <a href="/tags/codeplay/" style="font-size: 15px;">codeplay</a> <a href="/tags/硬件安全/" style="font-size: 15px;">硬件安全</a> <a href="/tags/goahead/" style="font-size: 15px;">goahead</a> <a href="/tags/LimeSDR/" style="font-size: 15px;">LimeSDR</a> <a href="/tags/无线电安全/" style="font-size: 15px;">无线电安全</a> <a href="/tags/火腿肠/" style="font-size: 15px;">火腿肠</a> <a href="/tags/xss/" style="font-size: 15px;">xss</a> <a href="/tags/xss-盲打/" style="font-size: 15px;">xss 盲打</a> <a href="/tags/终端安全/" style="font-size: 15px;">终端安全</a> <a href="/tags/绕过终端沙盒/" style="font-size: 15px;">绕过终端沙盒</a> <a href="/tags/zgrab/" style="font-size: 15px;">zgrab</a> <a href="/tags/zmap/" style="font-size: 15px;">zmap</a> <a href="/tags/无状态扫描/" style="font-size: 15px;">无状态扫描</a> <a href="/tags/运维/" style="font-size: 15px;">运维</a> <a href="/tags/Shellshock/" style="font-size: 15px;">Shellshock</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/Burp-Suite/" style="font-size: 15px;">Burp Suite</a> <a href="/tags/验证码识别/" style="font-size: 15px;">验证码识别</a> <a href="/tags/免杀/" style="font-size: 15px;">免杀</a> <a href="/tags/芯片安全/" style="font-size: 15px;">芯片安全</a> <a href="/tags/cmseasy/" style="font-size: 15px;">cmseasy</a> <a href="/tags/代理-ip/" style="font-size: 15px;">代理 ip</a> <a href="/tags/渗透测试/" style="font-size: 15px;">渗透测试</a> <a href="/tags/CVE-2014-4877/" style="font-size: 15px;">CVE-2014-4877</a> <a href="/tags/u盘破解/" style="font-size: 15px;">u盘破解</a> <a href="/tags/aes256-硬件加密破解/" style="font-size: 15px;">aes256 硬件加密破解</a> <a href="/tags/指纹加密u盘破解/" style="font-size: 15px;">指纹加密u盘破解</a> <a href="/tags/侧信道攻击/" style="font-size: 15px;">侧信道攻击</a> <a href="/tags/电磁攻击/" style="font-size: 15px;">电磁攻击</a> <a href="/tags/discuz-漏洞/" style="font-size: 15px;">discuz 漏洞</a> <a href="/tags/discuz-getshell/" style="font-size: 15px;">discuz getshell</a> <a href="/tags/uauc作品/" style="font-size: 15px;">uauc作品</a> <a href="/tags/discuz/" style="font-size: 15px;">discuz</a> <a href="/tags/discuz插件/" style="font-size: 15px;">discuz插件</a> <a href="/tags/c0deplay/" style="font-size: 15px;">c0deplay</a> <a href="/tags/firefox-插件/" style="font-size: 15px;">firefox 插件</a> <a href="/tags/firefox扩展/" style="font-size: 15px;">firefox扩展</a> <a href="/tags/firefox插件/" style="font-size: 15px;">firefox插件</a> <a href="/tags/Firefox/" style="font-size: 15px;">Firefox</a> <a href="/tags/firefox-扩展/" style="font-size: 15px;">firefox 扩展</a> <a href="/tags/无人超市/" style="font-size: 15px;">无人超市</a> <a href="/tags/无人超市安全/" style="font-size: 15px;">无人超市安全</a> <a href="/tags/无人超市破解/" style="font-size: 15px;">无人超市破解</a> <a href="/tags/无人超市零元购/" style="font-size: 15px;">无人超市零元购</a> <a href="/tags/安全参考/" style="font-size: 15px;">安全参考</a> <a href="/tags/漏洞月报/" style="font-size: 15px;">漏洞月报</a> <a href="/tags/xss绕过/" style="font-size: 15px;">xss绕过</a> <a href="/tags/智能锁/" style="font-size: 15px;">智能锁</a> <a href="/tags/蓝牙攻击/" style="font-size: 15px;">蓝牙攻击</a> <a href="/tags/hsts/" style="font-size: 15px;">hsts</a> <a href="/tags/hsts-bypass/" style="font-size: 15px;">hsts bypass</a> <a href="/tags/mitmf/" style="font-size: 15px;">mitmf</a> <a href="/tags/中间人攻击/" style="font-size: 15px;">中间人攻击</a> <a href="/tags/物联网安全/" style="font-size: 15px;">物联网安全</a> <a href="/tags/智能硬件安全/" style="font-size: 15px;">智能硬件安全</a> <a href="/tags/锁具安全/" style="font-size: 15px;">锁具安全</a> <a href="/tags/物理安全/" style="font-size: 15px;">物理安全</a> <a href="/tags/java-漏洞/" style="font-size: 15px;">java 漏洞</a> <a href="/tags/jboss-漏洞/" style="font-size: 15px;">jboss 漏洞</a> <a href="/tags/jquery-barrager-js/" style="font-size: 15px;">jquery.barrager.js</a> <a href="/tags/网页弹幕/" style="font-size: 15px;">网页弹幕</a> <a href="/tags/hexo-弹幕/" style="font-size: 15px;">hexo 弹幕</a> <a href="/tags/WordPress-插件/" style="font-size: 15px;">WordPress 插件</a> <a href="/tags/《黑客防线》/" style="font-size: 15px;">《黑客防线》</a> <a href="/tags/密码爆破/" style="font-size: 15px;">密码爆破</a> <a href="/tags/CVE-2014-9512/" style="font-size: 15px;">CVE-2014-9512</a> <a href="/tags/symbolic-link-attack/" style="font-size: 15px;">symbolic link attack</a> <a href="/tags/getshell/" style="font-size: 15px;">getshell</a> <a href="/tags/metinfo/" style="font-size: 15px;">metinfo</a> <a href="/tags/Mysql-注入-ddos/" style="font-size: 15px;">Mysql 注入 ddos</a> <a href="/tags/phpdisk/" style="font-size: 15px;">phpdisk</a> <a href="/tags/csrf/" style="font-size: 15px;">csrf</a> <a href="/tags/phpmywind-漏洞/" style="font-size: 15px;">phpmywind 漏洞</a> <a href="/tags/Rsync/" style="font-size: 15px;">Rsync</a> <a href="/tags/加密域可逆水印/" style="font-size: 15px;">加密域可逆水印</a> <a href="/tags/鲁棒可逆水印/" style="font-size: 15px;">鲁棒可逆水印</a> <a href="/tags/信息伪装/" style="font-size: 15px;">信息伪装</a> <a href="/tags/区块链安全/" style="font-size: 15px;">区块链安全</a> <a href="/tags/智能合约审计/" style="font-size: 15px;">智能合约审计</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/android-应用安全/" style="font-size: 15px;">android 应用安全</a> <a href="/tags/android安全/" style="font-size: 15px;">android安全</a> <a href="/tags/MITMf/" style="font-size: 15px;">MITMf</a> <a href="/tags/php代码审计/" style="font-size: 15px;">php代码审计</a> <a href="/tags/内核/" style="font-size: 15px;">内核</a> <a href="/tags/驱动/" style="font-size: 15px;">驱动</a> <a href="/tags/fddy/" style="font-size: 15px;">fddy</a> <a href="/tags/内核hook/" style="font-size: 15px;">内核hook</a> <a href="/tags/xdcms/" style="font-size: 15px;">xdcms</a> <a href="/tags/Xiuno/" style="font-size: 15px;">Xiuno</a> <a href="/tags/xss白盒分析/" style="font-size: 15px;">xss白盒分析</a> <a href="/tags/xss-利用平台/" style="font-size: 15px;">xss 利用平台</a> <a href="/tags/xssing/" style="font-size: 15px;">xssing</a> <a href="/tags/exp/" style="font-size: 15px;">exp</a> <a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/分布式扫描系统/" style="font-size: 15px;">分布式扫描系统</a> <a href="/tags/毕业论文/" style="font-size: 15px;">毕业论文</a> <a href="/tags/物理攻击/" style="font-size: 15px;">物理攻击</a> <a href="/tags/ChipWhisperer/" style="font-size: 15px;">ChipWhisperer</a> <a href="/tags/毛刺攻击/" style="font-size: 15px;">毛刺攻击</a> <a href="/tags/路由器漏洞/" style="font-size: 15px;">路由器漏洞</a> <a href="/tags/Android-反编译/" style="font-size: 15px;">Android 反编译</a> <a href="/tags/迅雷云播/" style="font-size: 15px;">迅雷云播</a> <a href="/tags/JTAGulator/" style="font-size: 15px;">JTAGulator</a> <a href="/tags/jtag/" style="font-size: 15px;">jtag</a> <a href="/tags/u-盘破解/" style="font-size: 15px;">u 盘破解</a> <a href="/tags/移动硬盘破解/" style="font-size: 15px;">移动硬盘破解</a> <a href="/tags/录音笔破解/" style="font-size: 15px;">录音笔破解</a> <a href="/tags/硬件分析/" style="font-size: 15px;">硬件分析</a> <a href="/tags/UART串口调试/" style="font-size: 15px;">UART串口调试</a> <a href="/tags/硬件修改/" style="font-size: 15px;">硬件修改</a> <a href="/tags/硬改/" style="font-size: 15px;">硬改</a> <a href="/tags/硬破/" style="font-size: 15px;">硬破</a> <a href="/tags/魔改/" style="font-size: 15px;">魔改</a> <a href="/tags/智能锁安全/" style="font-size: 15px;">智能锁安全</a> <a href="/tags/智能锁破解/" style="font-size: 15px;">智能锁破解</a> <a href="/tags/指纹锁安全/" style="font-size: 15px;">指纹锁安全</a> <a href="/tags/指纹锁破解/" style="font-size: 15px;">指纹锁破解</a> <a href="/tags/长毛开锁/" style="font-size: 15px;">长毛开锁</a> <a href="/tags/长毛锁王/" style="font-size: 15px;">长毛锁王</a> <a href="/tags/锁具-ctf/" style="font-size: 15px;">锁具 ctf</a> <a href="/tags/智能快递柜破解/" style="font-size: 15px;">智能快递柜破解</a> <a href="/tags/智能终端安全/" style="font-size: 15px;">智能终端安全</a> <a href="/tags/无线电/" style="font-size: 15px;">无线电</a> <a href="/tags/无线门铃逆向/" style="font-size: 15px;">无线门铃逆向</a> <a href="/tags/指纹识别/" style="font-size: 15px;">指纹识别</a> <a href="/tags/开锁/" style="font-size: 15px;">开锁</a> <a href="/tags/蓝牙锁破解/" style="font-size: 15px;">蓝牙锁破解</a> <a href="/tags/声波锁破解/" style="font-size: 15px;">声波锁破解</a> <a href="/tags/保险柜破解/" style="font-size: 15px;">保险柜破解</a> <a href="/tags/共享单车破解/" style="font-size: 15px;">共享单车破解</a> <a href="/tags/加密U盘破解/" style="font-size: 15px;">加密U盘破解</a> <a href="/tags/鬼吹灯/" style="font-size: 15px;">鬼吹灯</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/king-of-lock-4.html">《锁王创造营》 第四关：两会专题</a></li><li class="post-list-item"><a class="post-list-link" href="/king-of-lock-3.html">《锁王创造营》第三关：釜底抽薪</a></li><li class="post-list-item"><a class="post-list-link" href="/king-of-lock-2.html">《锁王创造营》第二关：暗度陈仓</a></li><li class="post-list-item"><a class="post-list-link" href="/king-of-lock-1.html">《锁王创造营》第一关：初出茅庐</a></li><li class="post-list-item"><a class="post-list-link" href="/diy-JTAGulator-and-debugging.html">嵌入式安全利器 JTAGulator 的制作与调试实战</a></li><li class="post-list-item"><a class="post-list-link" href="/something-about-information-hiding.html">信息安全之信息伪装</a></li><li class="post-list-item"><a class="post-list-link" href="/separable-robust-reversible-watermarking-in-encrypted-2d-vector-graphics-2.html">可完全分离的二维矢量图加密域鲁棒可逆水印算法（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/burp-suite-ip-switch-extension.html">强化 web 攻击神器 Burp Suite (二) — 切换 ip 技能点</a></li><li class="post-list-item"><a class="post-list-link" href="/burp-suite-captcha-crack-extension.html">强化 web 攻击神器 Burp Suite (一) — 验证码识别技能点</a></li><li class="post-list-item"><a class="post-list-link" href="/separable-robust-reversible-watermarking-in-encrypted-2d-vector-graphics-1.html">可完全分离的二维矢量图加密域鲁棒可逆水印算法（一）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.yaseng.org" title="Yaseng" target="_blank">Yaseng</a><ul></ul><a href="http://www.uauc.net" title="UaUc Net" target="_blank">UaUc Net</a><ul></ul><a href="http://future-sec.com" title="Future-sec" target="_blank">Future-sec</a><ul></ul><a href="http://secoff.net" title="b4dboy" target="_blank">b4dboy</a><ul></ul><a href="https://www.bg7ywl.com" title="BG7YWL's Blog" target="_blank">BG7YWL's Blog</a><ul></ul><a href="http://uauc.taobao.com" title="UaUc Taobao" target="_blank">UaUc Taobao</a><ul></ul><a href="http://iot-security.wiki" title="物联网安全百科" target="_blank">物联网安全百科</a><ul></ul><a href="https://shop135619923.taobao.com" title="物联网安全百科官方店" target="_blank">物联网安全百科官方店</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Yaseng.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="/js/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?63c0f1a94f0f01d28a0a7fe601154e81";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>